/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/@microsoft/signalr@6.0.4/dist/cjs/JsonHubProtocol.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JsonHubProtocol=void 0;const IHubProtocol_1=require("./IHubProtocol"),ILogger_1=require("./ILogger"),ITransport_1=require("./ITransport"),Loggers_1=require("./Loggers"),TextMessageFormat_1=require("./TextMessageFormat"),JSON_HUB_PROTOCOL_NAME="json";class JsonHubProtocol{constructor(){this.name="json",this.version=1,this.transferFormat=ITransport_1.TransferFormat.Text}parseMessages(e,o){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===o&&(o=Loggers_1.NullLogger.instance);const t=TextMessageFormat_1.TextMessageFormat.parse(e),r=[];for(const e of t){const t=JSON.parse(e);if("number"!=typeof t.type)throw new Error("Invalid payload.");switch(t.type){case IHubProtocol_1.MessageType.Invocation:this._isInvocationMessage(t);break;case IHubProtocol_1.MessageType.StreamItem:this._isStreamItemMessage(t);break;case IHubProtocol_1.MessageType.Completion:this._isCompletionMessage(t);break;case IHubProtocol_1.MessageType.Ping:case IHubProtocol_1.MessageType.Close:break;default:o.log(ILogger_1.LogLevel.Information,"Unknown message type '"+t.type+"' ignored.");continue}r.push(t)}return r}writeMessage(e){return TextMessageFormat_1.TextMessageFormat.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_assertNotEmptyString(e,o){if("string"!=typeof e||""===e)throw new Error(o)}}exports.JsonHubProtocol=JsonHubProtocol;
//# sourceMappingURL=/sm/7e4208ebcd294996ddf188b1ab8dc233611bbd2e677c82fff902169fa75a3c42.map